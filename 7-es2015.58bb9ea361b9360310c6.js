(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"2tF/":function(t,e,n){"use strict";var s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}();e.AsyncAction=function(t){function e(e,n){var s=t.call(this,e,n)||this;return s.scheduler=e,s.work=n,s.pending=!1,s}return s(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(s,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,s=void 0;try{this.work(t)}catch(i){n=!0,s=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),s},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,s=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==s&&n.splice(s,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(n("Dz+M").Action)},"Dz+M":function(t,e,n){"use strict";var s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}();e.Action=function(t){function e(e,n){return t.call(this)||this}return s(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(n("zB/H").Subscription)},GMZp:function(t,e,n){"use strict";e.isObject=function(t){return null!==t&&"object"==typeof t}},H0e8:function(t,e,n){"use strict";var s=n("O+eH");e.animationFrame=new(n("QY7M").AnimationFrameScheduler)(s.AnimationFrameAction)},LBXl:function(t,e,n){"use strict";e.UnsubscriptionError=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}()},NTcF:function(t,e,n){"use strict";var s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}(),i=n("ffpz");e.AsyncScheduler=function(t){function e(n,s){void 0===s&&(s=i.Scheduler.now);var r=t.call(this,n,(function(){return e.delegate&&e.delegate!==r?e.delegate.now():s()}))||this;return r.actions=[],r.active=!1,r.scheduled=void 0,r}return s(e,t),e.prototype.schedule=function(n,s,i){return void 0===s&&(s=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,s,i):t.prototype.schedule.call(this,n,s,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(i.Scheduler)},"O+eH":function(t,e,n){"use strict";var s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}();e.AnimationFrameAction=function(t){function e(e,n){var s=t.call(this,e,n)||this;return s.scheduler=e,s.work=n,s}return s(e,t),e.prototype.requestAsyncId=function(e,n,s){return void 0===s&&(s=0),null!==s&&s>0?t.prototype.requestAsyncId.call(this,e,n,s):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))},e.prototype.recycleAsyncId=function(e,n,s){if(void 0===s&&(s=0),null!==s&&s>0||null===s&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,s);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},e}(n("2tF/").AsyncAction)},QY7M:function(t,e,n){"use strict";var s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function s(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}();e.AnimationFrameScheduler=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,s=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++s<i&&(t=n.shift()));if(this.active=!1,e){for(;++s<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(n("NTcF").AsyncScheduler)},YanU:function(t,e,n){"use strict";n.r(e),n.d(e,"PostsModule",(function(){return j}));var s=n("ofXK"),i=n("PCNd"),r=n("tyNb"),o=n("lJxs"),c=n("pLZG"),a=n("3E0/"),u=n("H0e8"),h=n("fXoL"),p=n("2Vo4"),l=n("LvDl"),d=n("AytR");const f={isPostsLoading:!1,posts:{all:[],byId:{}}};var b=n("quSY");const g=new h.q("StreamSubscriptionToken");let y=(()=>{class t{constructor(t){this.token=t,this.subscriptions={},this.init=()=>{this.subscriptions[this.subToken]||(this.subscriptions[this.subToken]=new b.a)},this.add=t=>{this.init(),this.subscriptions[this.subToken].add(t)},this.unsubscribe=()=>{this.subscriptions[this.subToken]&&(this.subscriptions[this.subToken].unsubscribe(),this.subscriptions[this.subToken]=null)},this.execute=(t,e)=>{e&&e.pre&&e.pre(),this.add(t.subscribe(e))}}get subToken(){return this.token||t.defaultToken}}return t.defaultToken="SUBSCRIPTIONS",t.\u0275fac=function(e){return new(e||t)(h.Rb(g,8))},t.\u0275prov=h.Hb({token:t,factory:t.\u0275fac}),t})();var v=n("MWLU"),_=n("1Tb2");let m=(()=>{class t extends class{constructor(t){this.resetState=(t=this.initialState)=>{this.setState(t)},this.getState=()=>Object(l.mapValues)(this.innerState$,t=>t.getValue()),this.logPrevState=t=>{d.a.logState&&(console.groupCollapsed(`%c ${t} state changed`,"color: blue;"),console.log("%c prev state","color: red;",this.state))},this.logNextState=t=>{if(d.a.logState){const e=Object.keys(t).join(",");console.log("%c next state","color: green;",this.state),console.log("%c changed fields","color: blue;",e),console.groupEnd()}},this.innerState$=Object(l.mapValues)(t,t=>new p.a(t)),this.state$=Object(l.mapValues)(this.innerState$,t=>t.asObservable()),this.innerState=t,this.initialState=t}get state(){return this.innerState}setState(t){let e;e="function"==typeof t?t(this.state):t,this.logPrevState(this.constructor.name),Object.entries(e).forEach(([t,e])=>this.innerState$[t].next(e)),this.innerState=this.getState(),this.logNextState(e)}}{constructor(t,e,n){super(f),this.executions=t,this.dataNormalizer=e,this.postsApi=n,this.getPosts=()=>this.executions.execute(this.postsApi.getPosts({userId:8}),{pre:()=>{this.setState({isPostsLoading:!0})},next:t=>{const e=this.dataNormalizer.normalize(t);this.setState({isPostsLoading:!1,posts:e})}})}}return t.\u0275fac=function(e){return new(e||t)(h.Rb(y),h.Rb(v.a),h.Rb(_.a))},t.\u0275prov=h.Hb({token:t,factory:t.\u0275fac}),t})();var w=n("2RwD");let O=(()=>{class t{constructor(){this.alt="An image"}get webpSrcSet(){return`${this.imageBase}-1x.webp 1x, ${this.imageBase}-2x.webp 2x`}get pngSrcSet(){return`${this.imageBase}-1x.png 1x, ${this.imageBase}-2x.png 2x`}get normalSrc(){return`${this.imageBase}-1x.png`}get mockSrc(){return`${this.imageBase}-mock.png`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h.Fb({type:t,selectors:[["app-image"]],inputs:{styleClass:"styleClass",alt:"alt",imageBase:"imageBase",originalWidth:"originalWidth",originalHeight:"originalHeight"},decls:3,vars:12,consts:[[3,"type"],[3,"alt","src","width","height"]],template:function(t,e){1&t&&(h.Ob(0,"picture"),h.Mb(1,"source",0),h.Mb(2,"img",1),h.Nb()),2&t&&(h.Cb(e.styleClass),h.Ab(1),h.cc("type","image/webp"),h.Bb("data-srcset",e.webpSrcSet),h.Ab(1),h.Cb("lazy"),h.cc("alt",e.alt)("src",e.mockSrc,h.fc)("width",e.originalWidth)("height",e.originalHeight),h.Bb("data-src",e.normalSrc)("data-srcset",e.pngSrcSet))},styles:[".lazy[_ngcontent-%COMP%], picture[_ngcontent-%COMP%]{width:100%;height:auto}"],changeDetection:0}),t})();function S(t,e){1&t&&(h.Ob(0,"div",3),h.jc(1," Loading posts... "),h.Nb())}const x=function(t){return["/posts",t]};function A(t,e){if(1&t&&(h.Ob(0,"div",4),h.Ob(1,"h3"),h.jc(2),h.Nb(),h.Ob(3,"p"),h.jc(4),h.Nb(),h.Ob(5,"a",5),h.jc(6,"View"),h.Nb(),h.Ob(7,"p"),h.jc(8),h.Nb(),h.Mb(9,"app-image",6),h.Nb()),2&t){const t=e.$implicit,n=e.index;h.Ab(2),h.kc(t.title),h.Ab(2),h.mc("Post #",t.id," by user #",t.userId,""),h.Ab(1),h.cc("routerLink",h.dc(8,x,t.id)),h.Ab(3),h.lc(" ",t.body," "),h.Ab(1),h.cc("imageBase","/assets/images/blog/background-"+n)("originalWidth",1024)("originalHeight",683)}}const P=[{path:"",component:(()=>{class t{constructor(t,e,n){this.postsService=t,this.lazyLoadService=e,this.executions=n,this.isLoading$=this.postsService.state$.isPostsLoading,this.posts$=this.postsService.state$.posts.pipe(Object(o.a)(t=>t.all.map(e=>t.byId[e])))}ngOnInit(){this.executions.add(this.posts$.pipe(Object(c.a)(t=>!!t.length),Object(a.a)(0,u.animationFrame)).subscribe(()=>{this.lazyLoadService.update()})),this.postsService.getPosts()}ngOnDestroy(){this.executions.unsubscribe(),this.postsService.executions.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(h.Lb(m),h.Lb(w.a),h.Lb(y))},t.\u0275cmp=h.Fb({type:t,selectors:[["app-posts"]],decls:5,vars:6,consts:[[1,"posts"],["class","posts__loading",4,"ngIf"],["class","posts__card",4,"ngFor","ngForOf"],[1,"posts__loading"],[1,"posts__card"],[3,"routerLink"],[3,"imageBase","originalWidth","originalHeight"]],template:function(t,e){1&t&&(h.Ob(0,"div",0),h.ic(1,S,2,0,"div",1),h.Yb(2,"async"),h.ic(3,A,10,10,"div",2),h.Yb(4,"async"),h.Nb()),2&t&&(h.Ab(1),h.cc("ngIf",h.Zb(2,2,e.isLoading$)),h.Ab(2),h.cc("ngForOf",h.Zb(4,4,e.posts$)))},directives:[s.j,s.i,r.e,O],pipes:[s.b],styles:[".posts[_ngcontent-%COMP%]{max-width:1024px;margin:0 auto;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;padding:30px 0}.posts__card[_ngcontent-%COMP%]{width:calc((100% - 15px)/2);border:1px solid #ccc;border-radius:10px;padding:15px;box-sizing:border-box;margin-bottom:15px}.posts__card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-transform:uppercase}.posts[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:inherit}@media screen and (max-width:1024px){.posts__card[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),t})()},{path:":slug",component:(()=>{class t{constructor(t){this.activatedRoute=t,this.postSlug$=this.activatedRoute.paramMap.pipe(Object(o.a)(t=>t.get("slug")))}}return t.\u0275fac=function(e){return new(e||t)(h.Lb(r.a))},t.\u0275cmp=h.Fb({type:t,selectors:[["app-post"]],decls:3,vars:3,consts:[[1,"post"]],template:function(t,e){1&t&&(h.Ob(0,"div",0),h.jc(1),h.Yb(2,"async"),h.Nb()),2&t&&(h.Ab(1),h.lc('I am post identified as "',h.Zb(2,1,e.postSlug$),'"'))},pipes:[s.b],styles:[".post[_ngcontent-%COMP%]{max-width:300px;padding:30px;border:1px solid #ccc;border-radius:5px;margin:45px auto}"],changeDetection:0}),t})()}];let j=(()=>{class t{}return t.\u0275mod=h.Jb({type:t}),t.\u0275inj=h.Ib({factory:function(e){return new(e||t)},providers:[m,y],imports:[[s.c,i.a,r.f.forChild(P)]]}),t})()},ffpz:function(t,e,n){"use strict";e.Scheduler=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}()},mbIT:function(t,e,n){"use strict";e.isArray=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}()},pshJ:function(t,e,n){"use strict";e.isFunction=function(t){return"function"==typeof t}},"zB/H":function(t,e,n){"use strict";var s=n("mbIT"),i=n("GMZp"),r=n("pshJ"),o=n("LBXl");function c(t){return t.reduce((function(t,e){return t.concat(e instanceof o.UnsubscriptionError?e.errors:e)}),[])}e.Subscription=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this._parentOrParents,a=this._unsubscribe,u=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var h=0;h<n.length;++h)n[h].remove(this);if(r.isFunction(a))try{a.call(this)}catch(d){e=d instanceof o.UnsubscriptionError?c(d.errors):[d]}if(s.isArray(u)){h=-1;for(var p=u.length;++h<p;){var l=u[h];if(i.isObject(l))try{l.unsubscribe()}catch(d){e=e||[],d instanceof o.UnsubscriptionError?e=e.concat(c(d.errors)):e.push(d)}}}if(e)throw new o.UnsubscriptionError(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var s=n;(n=new t)._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}()}}]);