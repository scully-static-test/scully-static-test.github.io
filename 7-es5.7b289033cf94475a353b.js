function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(a){i=!0,o=a}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(t);if(e){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"2tF/":function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.AsyncAction=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return i(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(n("Dz+M").Action)},"Dz+M":function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.Action=function(t){function e(e,n){return t.call(this)||this}return i(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(n("zB/H").Subscription)},GMZp:function(t,e,n){"use strict";e.isObject=function(t){return null!==t&&"object"==typeof t}},H0e8:function(t,e,n){"use strict";var r=n("O+eH");e.animationFrame=new(n("QY7M").AnimationFrameScheduler)(r.AnimationFrameAction)},LBXl:function(t,e,n){"use strict";e.UnsubscriptionError=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}()},NTcF:function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=n("ffpz");e.AsyncScheduler=function(t){function e(n,r){void 0===r&&(r=o.Scheduler.now);var i=t.call(this,n,(function(){return e.delegate&&e.delegate!==i?e.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return i(e,t),e.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,i):t.prototype.schedule.call(this,n,r,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(o.Scheduler)},"O+eH":function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.AnimationFrameAction=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return i(e,t),e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},e}(n("2tF/").AsyncAction)},QY7M:function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.AnimationFrameScheduler=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,r=-1,i=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++r<i&&(t=n.shift()));if(this.active=!1,e){for(;++r<i&&(t=n.shift());)t.unsubscribe();throw e}},e}(n("NTcF").AsyncScheduler)},YanU:function(t,e,n){"use strict";n.r(e),n.d(e,"PostsModule",(function(){return M}));var r,i,o,s=n("ofXK"),c=n("PCNd"),a=n("tyNb"),u=n("lJxs"),l=n("pLZG"),p=n("3E0/"),f=n("H0e8"),h=n("fXoL"),d=n("2Vo4"),b=n("LvDl"),y=n("AytR"),g={isPostsLoading:!1,posts:{all:[],byId:{}}},_=n("quSY"),v=new h.q("StreamSubscriptionToken"),m=((r=function(){function t(e){var n=this;_classCallCheck(this,t),this.token=e,this.subscriptions={},this.init=function(){n.subscriptions[n.subToken]||(n.subscriptions[n.subToken]=new _.a)},this.add=function(t){n.init(),n.subscriptions[n.subToken].add(t)},this.unsubscribe=function(){n.subscriptions[n.subToken]&&(n.subscriptions[n.subToken].unsubscribe(),n.subscriptions[n.subToken]=null)},this.execute=function(t,e){e&&e.pre&&e.pre(),n.add(t.subscribe(e))}}return _createClass(t,[{key:"subToken",get:function(){return this.token||t.defaultToken}}]),t}()).defaultToken="SUBSCRIPTIONS",r.\u0275fac=function(t){return new(t||r)(h.Rb(v,8))},r.\u0275prov=h.Hb({token:r,factory:r.\u0275fac}),r),O=n("MWLU"),w=n("1Tb2"),S=((i=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,r,i){var o;return _classCallCheck(this,n),(o=e.call(this,g)).executions=t,o.dataNormalizer=r,o.postsApi=i,o.getPosts=function(){return o.executions.execute(o.postsApi.getPosts({userId:8}),{pre:function(){o.setState({isPostsLoading:!0})},next:function(t){var e=o.dataNormalizer.normalize(t);o.setState({isPostsLoading:!1,posts:e})}})},o}return n}(function(){function t(e){var n=this;_classCallCheck(this,t),this.resetState=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.initialState;n.setState(t)},this.getState=function(){return Object(b.mapValues)(n.innerState$,(function(t){return t.getValue()}))},this.logPrevState=function(t){y.a.logState&&(console.groupCollapsed("%c ".concat(t," state changed"),"color: blue;"),console.log("%c prev state","color: red;",n.state))},this.logNextState=function(t){if(y.a.logState){var e=Object.keys(t).join(",");console.log("%c next state","color: green;",n.state),console.log("%c changed fields","color: blue;",e),console.groupEnd()}},this.innerState$=Object(b.mapValues)(e,(function(t){return new d.a(t)})),this.state$=Object(b.mapValues)(this.innerState$,(function(t){return t.asObservable()})),this.innerState=e,this.initialState=e}return _createClass(t,[{key:"setState",value:function(t){var e,n=this;e="function"==typeof t?t(this.state):t,this.logPrevState(this.constructor.name),Object.entries(e).forEach((function(t){var e=_slicedToArray(t,2),r=e[0],i=e[1];return n.innerState$[r].next(i)})),this.innerState=this.getState(),this.logNextState(e)}},{key:"state",get:function(){return this.innerState}}]),t}())).\u0275fac=function(t){return new(t||i)(h.Rb(m),h.Rb(O.a),h.Rb(w.a))},i.\u0275prov=h.Hb({token:i,factory:i.\u0275fac}),i),A=n("2RwD"),x=((o=function(){function t(){_classCallCheck(this,t),this.alt="An image"}return _createClass(t,[{key:"webpSrcSet",get:function(){return"".concat(this.imageBase,"-1x.webp 1x, ").concat(this.imageBase,"-2x.webp 2x")}},{key:"pngSrcSet",get:function(){return"".concat(this.imageBase,"-1x.png 1x, ").concat(this.imageBase,"-2x.png 2x")}},{key:"normalSrc",get:function(){return"".concat(this.imageBase,"-1x.png")}},{key:"mockSrc",get:function(){return"".concat(this.imageBase,"-mock.png")}}]),t}()).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=h.Fb({type:o,selectors:[["app-image"]],inputs:{styleClass:"styleClass",alt:"alt",imageBase:"imageBase",originalWidth:"originalWidth",originalHeight:"originalHeight"},decls:3,vars:12,consts:[[3,"type"],[3,"alt","src","width","height"]],template:function(t,e){1&t&&(h.Ob(0,"picture"),h.Mb(1,"source",0),h.Mb(2,"img",1),h.Nb()),2&t&&(h.Cb(e.styleClass),h.Ab(1),h.cc("type","image/webp"),h.Bb("data-srcset",e.webpSrcSet),h.Ab(1),h.Cb("lazy"),h.cc("alt",e.alt)("src",e.mockSrc,h.fc)("width",e.originalWidth)("height",e.originalHeight),h.Bb("data-src",e.normalSrc)("data-srcset",e.pngSrcSet))},styles:[".lazy[_ngcontent-%COMP%], picture[_ngcontent-%COMP%]{width:100%;height:auto}"],changeDetection:0}),o);function P(t,e){1&t&&(h.Ob(0,"div",3),h.ic(1," Loading posts... "),h.Nb())}var k=function(t){return["/posts",t]};function C(t,e){if(1&t&&(h.Ob(0,"div",4),h.Ob(1,"h3"),h.ic(2),h.Nb(),h.Ob(3,"p"),h.ic(4),h.Nb(),h.Ob(5,"a",5),h.ic(6,"View"),h.Nb(),h.Ob(7,"p"),h.ic(8),h.Nb(),h.Mb(9,"app-image",6),h.Nb()),2&t){var n=e.$implicit,r=e.index;h.Ab(2),h.jc(n.title),h.Ab(2),h.lc("Post #",n.id," by user #",n.userId,""),h.Ab(1),h.cc("routerLink",h.dc(8,k,n.id)),h.Ab(3),h.kc(" ",n.body," "),h.Ab(1),h.cc("imageBase","/assets/images/blog/background-"+r)("originalWidth",1024)("originalHeight",683)}}var j,I,T,L=[{path:"",component:(I=function(){function t(e,n,r){_classCallCheck(this,t),this.postsService=e,this.lazyLoadService=n,this.executions=r,this.isLoading$=this.postsService.state$.isPostsLoading,this.posts$=this.postsService.state$.posts.pipe(Object(u.a)((function(t){return t.all.map((function(e){return t.byId[e]}))})))}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.executions.add(this.posts$.pipe(Object(l.a)((function(t){return!!t.length})),Object(p.a)(0,f.animationFrame)).subscribe((function(){t.lazyLoadService.update()}))),this.postsService.getPosts()}},{key:"ngOnDestroy",value:function(){this.executions.unsubscribe(),this.postsService.executions.unsubscribe()}}]),t}(),I.\u0275fac=function(t){return new(t||I)(h.Lb(S),h.Lb(A.a),h.Lb(m))},I.\u0275cmp=h.Fb({type:I,selectors:[["app-posts"]],decls:5,vars:6,consts:[[1,"posts"],["class","posts__loading",4,"ngIf"],["class","posts__card",4,"ngFor","ngForOf"],[1,"posts__loading"],[1,"posts__card"],[3,"routerLink"],[3,"imageBase","originalWidth","originalHeight"]],template:function(t,e){1&t&&(h.Ob(0,"div",0),h.hc(1,P,2,0,"div",1),h.Yb(2,"async"),h.hc(3,C,10,10,"div",2),h.Yb(4,"async"),h.Nb()),2&t&&(h.Ab(1),h.cc("ngIf",h.Zb(2,2,e.isLoading$)),h.Ab(2),h.cc("ngForOf",h.Zb(4,4,e.posts$)))},directives:[s.j,s.i,a.e,x],pipes:[s.b],styles:[".posts[_ngcontent-%COMP%]{max-width:1024px;margin:0 auto;display:flex;align-items:flex-start;justify-content:space-between;flex-wrap:wrap;padding:30px 0}.posts__card[_ngcontent-%COMP%]{width:calc((100% - 15px)/2);border:1px solid #ccc;border-radius:10px;padding:15px;box-sizing:border-box;margin-bottom:15px}.posts__card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-transform:uppercase}@media screen and (max-width:1024px){.posts__card[_ngcontent-%COMP%]{width:100%}}"],changeDetection:0}),I)},{path:":slug",component:(j=function t(e){_classCallCheck(this,t),this.activatedRoute=e,this.postSlug$=this.activatedRoute.paramMap.pipe(Object(u.a)((function(t){return t.get("slug")})))},j.\u0275fac=function(t){return new(t||j)(h.Lb(a.a))},j.\u0275cmp=h.Fb({type:j,selectors:[["app-post"]],decls:3,vars:3,consts:[[1,"post"]],template:function(t,e){1&t&&(h.Ob(0,"div",0),h.ic(1),h.Yb(2,"async"),h.Nb()),2&t&&(h.Ab(1),h.kc('I am post identified as "',h.Zb(2,1,e.postSlug$),'"'))},pipes:[s.b],styles:[".post[_ngcontent-%COMP%]{max-width:300px;padding:30px;border:1px solid #ccc;border-radius:5px;margin:45px auto}"],changeDetection:0}),j)}],M=((T=function t(){_classCallCheck(this,t)}).\u0275mod=h.Jb({type:T}),T.\u0275inj=h.Ib({factory:function(t){return new(t||T)},providers:[S,m],imports:[[s.c,c.a,a.f.forChild(L)]]}),T)},ffpz:function(t,e,n){"use strict";e.Scheduler=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}()},mbIT:function(t,e,n){"use strict";e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}},pshJ:function(t,e,n){"use strict";e.isFunction=function(t){return"function"==typeof t}},"zB/H":function(t,e,n){"use strict";var r=n("mbIT"),i=n("GMZp"),o=n("pshJ"),s=n("LBXl");function c(t){return t.reduce((function(t,e){return t.concat(e instanceof s.UnsubscriptionError?e.errors:e)}),[])}e.Subscription=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this._parentOrParents,a=this._unsubscribe,u=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var l=0;l<n.length;++l)n[l].remove(this);if(o.isFunction(a))try{a.call(this)}catch(h){e=h instanceof s.UnsubscriptionError?c(h.errors):[h]}if(r.isArray(u)){l=-1;for(var p=u.length;++l<p;){var f=u[l];if(i.isObject(f))try{f.unsubscribe()}catch(h){e=e||[],h instanceof s.UnsubscriptionError?e=e.concat(c(h.errors)):e.push(h)}}}if(e)throw new s.UnsubscriptionError(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}()}}]);